# redux-middle란?

리덕스 미들웨어란 액션을 디스패치했을 때 스토어보내기 전 이를 처리하기에 앞서 사전에 지정된 작업들을 실행한다.

미들웨어는 액션과 리듀서 사이의 중간자라고 생각하면 된다.  
때문에 액션을 리듀서로 보내기전에 추가적인 기능을 중간에 입혀서 보내고 싶을 때 사용하기에 유용하며 주로 비동기작업을 할 때 사용된다.

예를 들어 액션에 대하여 비동기로 사용하고 싶을 때 리듀서로 보내기전 중간에서 비동기로 변형하여 해당 액션값을 리듀서로 보내는 것이다.

이외에도 리듀서가 액션을 처리하기 전에 미들웨어는 전달받은 액션을 단순히 콘솔에 기록하거나 전달받은 액션 정보를 기반으로 액션을 아예 취소하거나 다른 종류의 액션을 추가로 디스패치할 수 있다.

## 기본 미들 웨어 구조

```js
const middleware = (store) => (next) => (action) => {};
```

위 미들웨어 함수는 기본 미들웨어의 구조이다.  
미들웨어는 **함수를 반환하는 함수를 반환하는 함수**이다.

위 미들웨어 예시에서 각 인자의 역할에 대하여 **store는 리덕스 스토어 인스터스**를, **action은 디스패치된 액션**을 가르킨다.  
 **next는 함수 형태**이며 next(action)을 호출하면 그 다음 처리해야 할 미들웨어에게 액션을 넘겨주고 만약 그 다음 미들웨어가 없다면 리듀서에게 액션을 넘겨준다.
미들웨어내에서 **next()를 호출하지않으면 액션은 리듀서에 전달되지 않는다.**

내부적으로 살펴보면 **next는 store.dispatch함수를 재구성한 함수**이다.  
즉, next는 dispatch의 역할이므로 미들웨어안에서 디스패치로 액션값을 보내줄 수 있다.

dispatch로 미들웨어를 보내주면 미들웨어안에서 보낼 dispatch(action)에 대한 로직이 구현된다.  
즉, 미들웨어는 내부의 dispatch()를 위해 사용되는 수단이다.

이처럼 미들웨어는 이전 액션과 디스패치후 바뀐 액션값을 조회하거나 스토어로 보내기 이전 작업을 할 때 사용할 수 있다.

**ref**

- https://redux.js.org/understanding/history-and-design/middleware

## 오픈 소스 미들웨어

리덕스 오픈 소스 미들웨어로 가장 많이 사용하는 것은 **redux-thunk와 redux-saga**가 있다.

**redux-thunk**는 **비동기 작업**을 처리할 때 가장 많이 사용하는 미들웨어이다.  
객체가 아닌 **함수 형태의 액션을 디스패치**할 수 있게 해준다.

**redux-saga**는 redux-thunk 다음으로 가장 많이 사용되는 비동기 작업 관련 미들웨어이다. 특정 액션이 디스패치되었을 때 정해진 로직에 따라 다른 액션을 디스패치시키려는 규칙을 작성하여 비동기 작업을 처리할 수 있게 해준다.
